import{d as v,m as d,G as c,l as I,e as a,f as u,g as t,t as m,F as g,v as x,h as Q,H as f,z as P}from"./index-6c282606.js";const y=v({name:"Answers",data:function(){return{index:0,parties:[],questions:[],answers:[],newAnswers:[],modifiedAnswers:[]}},computed:{currentQuestion(){return this.questions[this.index]}},async created(){this.parties=await d({url:"parties"}),this.questions=await d({url:"questions"}),this.answers=await d({url:"answers"})},methods:{changeAgreeLevel(e,n){const r=this.currentQuestion,l=this.answers.find(s=>s.QuestionId===r.id&&s.PartyId===e),w=this.newAnswers.findIndex(s=>s.QuestionId===r.id&&s.PartyId===e);w!==-1&&this.newAnswers.splice(w,1);const h=this.modifiedAnswers.findIndex(s=>s.QuestionId===r.id&&s.PartyId===e);if(h!==-1&&this.modifiedAnswers.splice(h,1),n){const s={PartyId:e,QuestionId:r.id,agreeLevel:parseInt(n)};console.log("existing:",!!l,"answer:",s),l?this.modifiedAnswers.push(s):this.newAnswers.push(s)}},async sendAnswers(){console.log("sending these:",this.newAnswers),c({url:"answers",body:this.newAnswers}),this.modifiedAnswers.forEach(e=>{c({url:`answers/${e.QuestionId}/${e.PartyId}`,body:e,method:"PUT"})}),this.newAnswers=[],this.modifiedAnswers=[],this.answers=await d({url:"answers"})}}}),$={key:0,class:"h-24"},k={class:"inline-flex flex-col"},C=["value","onChange"];function q(e,n,r,l,w,h){var s,p;return a(),u(g,null,[(s=e.questions)!=null&&s.length&&((p=e.parties)!=null&&p.length)?(a(),u("div",$,[t("div",null,m(e.questions[e.index].title),1),(a(!0),u(g,null,x(e.parties,i=>{var A;return a(),u("span",{key:i.id},[t("span",k,[P(m(i.abbreviation)+" ",1),t("input",{type:"number",max:"5",min:"1",class:"w-16",value:(A=e.answers.find(o=>o.QuestionId===e.currentQuestion.id&&o.PartyId===i.id))==null?void 0:A.agreeLevel,onChange:o=>e.changeAgreeLevel(i.id,o.target.value)},null,40,C)])])}),128))])):Q("",!0),t("a",{href:"#",onClick:n[0]||(n[0]=f(i=>e.index--,["prevent"]))}," Předchozí "),t("a",{href:"#",onClick:n[1]||(n[1]=f((...i)=>e.sendAnswers&&e.sendAnswers(...i),["prevent"]))}," Odeslat "),t("a",{href:"#",onClick:n[2]||(n[2]=f(i=>e.index++,["prevent"]))}," Další ")],64)}const D=I(y,[["render",q]]);export{D as default};
